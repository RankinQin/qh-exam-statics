var e=Object.defineProperty,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;import{o as n,c as l,w as i,y as o,x as u,v as p,j as d,I as c,s as f,g as h,n as m,e as g,h as b,d as y,J as x,t as _,f as C,r as w,F as I,K as v,C as N,k as j,L as k,i as $,M as S,N as O}from"./index.d7537bc6.js";import{_ as Q}from"./plugin-vue_export-helper.21dcd24c.js";import{r as L}from"./uni-app.es.f6cd1c1c.js";import{_ as z,a as q}from"./uni-popup.67d8a74b.js";import{b as R,s as E}from"./api.66e70d95.js";var J=Q({name:"uniRow",componentName:"uniRow",props:{type:String,gutter:Number,justify:{type:String,default:"start"},align:{type:String,default:"top"},width:{type:[String,Number],default:750}},created(){},computed:{marginValue(){return this.gutter?-this.gutter/2:0},typeClass(){return"flex"===this.type?"uni-row--flex":""},justifyClass(){return"start"!==this.justify?`uni-row--flex-justify-${this.justify}`:""},alignClass(){return"top"!==this.align?`uni-row--flex-align-${this.align}`:""}}},[["render",function(e,t,s,a,r,c){const f=d;return n(),l(f,{class:u(["uni-row",c.typeClass,c.justifyClass,c.alignClass]),style:p({marginLeft:`${Number(c.marginValue)}rpx`,marginRight:`${Number(c.marginValue)}rpx`})},{default:i((()=>[o(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])}],["__scopeId","data-v-7cc0bccb"]]);var M=Q({name:"uniCol",props:{span:{type:Number,default:24},offset:{type:Number,default:-1},pull:{type:Number,default:-1},push:{type:Number,default:-1},xs:[Number,Object],sm:[Number,Object],md:[Number,Object],lg:[Number,Object],xl:[Number,Object]},data:()=>({gutter:0,sizeClass:"",parentWidth:0,nvueWidth:0,marginLeft:0,right:0,left:0}),created(){let e=this.$parent;for(;e&&"uniRow"!==e.$options.componentName;)e=e.$parent;this.updateGutter(e.gutter),e.$watch("gutter",(e=>{this.updateGutter(e)}))},computed:{sizeList(){let{span:e,offset:t,pull:s,push:a}=this;return{span:e,offset:t,pull:s,push:a}},pointClassList(){let e=[];return["xs","sm","md","lg","xl"].forEach((t=>{const s=this[t];"number"==typeof s?e.push(`uni-col-${t}-${s}`):"object"==typeof s&&s&&Object.keys(s).forEach((a=>{e.push("span"===a?`uni-col-${t}-${s[a]}`:`uni-col-${t}-${a}-${s[a]}`)}))})),e.join(" ")}},methods:{updateGutter(e){e=Number(e),isNaN(e)||(this.gutter=e/2)}},watch:{sizeList:{immediate:!0,handler(e){let t=[];for(let s in e){const a=e[s];!a&&0!==a||-1===a||t.push("span"===s?`uni-col-${a}`:`uni-col-${s}-${a}`)}this.sizeClass=t.join(" ")}}}},[["render",function(e,t,s,a,r,c){const f=d;return n(),l(f,{class:u(["uni-col",r.sizeClass,c.pointClassList]),style:p({paddingLeft:`${Number(r.gutter)}rpx`,paddingRight:`${Number(r.gutter)}rpx`})},{default:i((()=>[o(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])}],["__scopeId","data-v-046da4c8"]]);var T=Q({data:()=>({ios:!1,testpaper:{},leafQuestions:[],questionMap:{},currentIdx:0,answers:{},popupHaveShow:!1}),computed:{optionSelected:()=>function(e,t,s){return s&&s[t.id]&&s[t.id].includes(""+e)},enChar:()=>e=>String.fromCharCode(e+64),chinesNum:()=>e=>{let t=["零","一","二","三","四","五","六","七","八","九"],s=["","十","百","千","万"];e=parseInt(e);let a=e=>{let a=e.toString().split("").reverse(),r="";for(var n=0;n<a.length;n++)r=(0==n&&0==a[n]||n>0&&0==a[n]&&0==a[n-1]?"":t[a[n]]+(0==a[n]?s[0]:s[n]))+r;return r},r=Math.floor(e/1e4),n=e%1e4;return n.toString().length<4&&(n="0"+n),r?a(r)+"万"+a(n):a(e)}},async onLoad(e){const t=e.id;try{this.testpaper=await R(t),c({title:this.testpaper.name}),this.isIos()&&this.testpaper.amount>0&&(this.ios=!0);let e=[],s=1,a=1;this.testpaper.questions.forEach((t=>{this.questionMap[t.id]=t,3107!=t.type?(t.leafId=a++,e.push(t)):t.titleId=s++,t.options&&(t.options=JSON.parse(t.options))})),this.leafQuestions=e}catch(s){console.error(s)}},methods:{isIos(){},doSingleChoiceAnswerCheck(e,t){console.log(e,t),this.answers[t.id]=[e.detail.value],setTimeout((()=>{this.next()}),90)},prev(){this.currentIdx>=1&&this.currentIdx--},next(){this.currentIdx<this.leafQuestions.length-1?this.currentIdx++:this.currentIdx!=this.leafQuestions.length-1||this.popupHaveShow||(this.popupHaveShow=!0,this.$refs.popup.open())},submit(){console.log(JSON.stringify(this.answers)),E(this.testpaper.id,this.answers).then((e=>{console.log(e);let n={};e.result&&(n=e.result?JSON.parse(e.result):void 0),f("tmp_order",((e,n)=>{for(var l in n||(n={}))s.call(n,l)&&r(e,l,n[l]);if(t)for(var l of t(n))a.call(n,l)&&r(e,l,n[l]);return e})({testpaper:this.testpaper,answers:this.answers,order:e},n)),console.log(h("tmp_order")),m({url:"/pages/exam/result/result?paperId="+this.testpaper.id})}))},dialogClose(){},dialogConfirm(){}}},[["render",function(e,t,s,a,r,o){const p=d,c=v,f=k,h=$,m=S,Q=L(N("uni-row"),J),R=O,E=j,T=L(N("uni-col"),M),G=L(N("uni-popup-dialog"),z),H=L(N("uni-popup"),q);return n(),l(p,{class:"question-content"},{default:i((()=>[r.ios?(n(),l(p,{key:0,style:{background:"#bbcaff","font-size":"14px",padding:"4px"}},{default:i((()=>[g("由于政策原因，ios暂不支持虚拟商品付款")])),_:1})):b("",!0),y(p,{class:"progress-content border-shadow"},{default:i((()=>[y(p,{class:"pc-progress"},{default:i((()=>[y(c,{activeColor:"#2979ff",percent:(r.currentIdx+1)/r.leafQuestions.length*100,"stroke-width":10,"show-info":!1},null,8,["percent"])])),_:1}),y(p,{class:"pc-text"},{default:i((()=>[x("span",null,_(r.currentIdx+1)+"/"+_(r.leafQuestions.length),1)])),_:1})])),_:1}),y(p,{class:"title"},{default:i((()=>[x("h3",null,_(r.testpaper.name),1),r.testpaper.examCount?(n(),l(p,{key:0},{default:i((()=>[g("当前已有"+_(r.testpaper.examCount)+"人完成测评",1)])),_:1})):b("",!0)])),_:1}),y(p,{class:"answer border-shadow"},{default:i((()=>[(n(!0),C(I,null,w(r.testpaper.questions,((e,t)=>(n(),l(p,{key:e.id},{default:i((()=>[3107===e.type&&r.leafQuestions[r.currentIdx]&&r.leafQuestions[r.currentIdx].parentId===e.id?(n(),l(p,{key:0,class:"section"},{default:i((()=>[g(_(o.chinesNum(e.titleId))+") "+_(e.stem),1)])),_:2},1024)):b("",!0),3101===e.type&&r.leafQuestions[r.currentIdx]&&r.leafQuestions[r.currentIdx].id==e.id?(n(),l(p,{key:1,class:"body"},{default:i((()=>[e.stem?(n(),l(p,{key:0,class:"stem"},{default:i((()=>[g(_(e.leafId)+"."+_(e.stem),1)])),_:2},1024)):b("",!0),y(p,{class:"option-content"},{default:i((()=>[y(R,{onChange:t=>o.doSingleChoiceAnswerCheck(t,e),name:""+e.id},{default:i((()=>[(n(!0),C(I,null,w(e.options.choices,((t,s)=>(n(),l(p,{class:u(["option",{selected:o.optionSelected(s,e,r.answers)}]),key:s},{default:i((()=>[y(Q,null,{default:i((()=>[y(m,{class:"opt-label"},{default:i((()=>[y(f,{color:"#2979ff",value:""+s,checked:o.optionSelected(s,e,r.answers)},null,8,["value","checked"]),y(h,{class:"lb"},{default:i((()=>[g(_(o.enChar(s+1))+"."+_(t),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:2},1032,["onChange","name"])])),_:2},1024)])),_:2},1024)):b("",!0)])),_:2},1024)))),128))])),_:1}),y(p,{class:"buttom border-shadow"},{default:i((()=>[y(Q,null,{default:i((()=>[y(T,{span:12},{default:i((()=>[y(E,{class:"but",onClick:o.prev,disabled:0===r.currentIdx},{default:i((()=>[g("上一题")])),_:1},8,["onClick","disabled"])])),_:1}),r.currentIdx<r.leafQuestions.length-1?(n(),l(T,{key:0,span:12},{default:i((()=>[y(E,{class:"but pri",type:"primary",onClick:o.next,disabled:!r.answers[r.leafQuestions[r.currentIdx].id]},{default:i((()=>[g("下一题")])),_:1},8,["onClick","disabled"])])),_:1})):r.leafQuestions.length>0?(n(),l(T,{key:1,span:12},{default:i((()=>[y(E,{class:"but pri",disabled:!r.answers[r.leafQuestions[r.currentIdx].id],type:"primary",onClick:o.submit},{default:i((()=>[g("提交答案")])),_:1},8,["disabled","onClick"])])),_:1})):b("",!0)])),_:1})])),_:1}),y(H,{ref:"popup",type:"dialog"},{default:i((()=>[y(G,{type:"msgType",cancelText:"关闭",confirmText:"查看测评结果",title:"已完成测评",content:"现在提交测评？",onConfirm:o.submit,onClose:o.dialogClose},null,8,["onConfirm","onClose"])])),_:1},512)])),_:1})}],["__scopeId","data-v-1dbea7f8"]]);export{T as default};
